# Безградиентная оптимизация в задаче светофорного регулирования

Репозиторий проекта "Безградиентная оптимизация в задаче светофорного регулирования" в рамках смены "Современные методы теории информации и оптимизации"

## Настройка окружения

Для работы потребуется пакет `traffic_model`, который в настоящий момент нельзя выкладывать в открытый доступ.
Чтобы его получить напишите мне на почту.

Создать виртуальное окружения и запулить зависимости:
```sh
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.lock.txt
```

## Валидация макро-модели при помощи SUMO

Настройка графа в sumo:
1. Граничным нодам нужно прописывать property `end_node=true`
2. На полосе ставится N детекторов с названиями `{lane_id}_{n}_loop`. В начале входных полос дополнительно ставится детектор с название `{lane_id}_start_loop`. Для установки детекторов можно использовать скрипт `add_loop_detectors`
3. В `grid.net.xml` необходимо задавать базовые планы с `programID="default"`
3. Для фаз в программе нужно добавлять поле `name` (основной такт - `{phase_number}`, пром такты - `{phase_number}_int`)
4. `tlLogic.id` должен совпадать с `node_id` на котором стоит светофор
5. Для оптимизации в папку со сценарием нужно добавить ограничения `plan_constraints.json` (можно использовать скрипт `add_plan_constraints`)

## Вспомогательные скрипты

В папке `scripts` лежат следующие скрипты:
1. `add_loop_detectors.py` - добавляет детекторы на граф транспортной сети
2. `add_plan_constraints.py` - строит ограничения для оптимизации
3. `plot_score.py` - визуализация сходимости локального поиска

Как запускать:
```sh
python -m scripts.script_name [OPTIONS]
```
